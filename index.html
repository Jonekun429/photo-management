<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cleaner Pro</title>
    <style>
        :root {
            --bg: #04100e;
            --card: #0c1f1b;
            --card-hover: #153029;
            --text: #eaf5f2;
            --text-sub: #5a7d75;
            --text-dim: #3d5c54;
            --primary: #005D4D;
            --primary-mid: #00896e;
            --primary-bright: #00b894;
            --primary-grad: linear-gradient(135deg, #005D4D, #00896e);
            --primary-glow: rgba(0, 93, 77, 0.25);
            --danger: #ff4757;
            --danger-grad: linear-gradient(135deg, #ff4757, #ff6b7a);
            --amber: #ffb142;
            --badge-bg: rgba(4, 16, 14, 0.82);
            --border: rgba(0, 93, 77, 0.12);
            --border-active: rgba(0, 93, 77, 0.3);
            --shadow: 0 8px 32px rgba(0,0,0,0.4);
            --r-lg: 20px; --r-md: 14px; --r-sm: 10px;
        }
        *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
        body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Helvetica Neue",sans-serif;background:#000;display:flex;justify-content:center;touch-action:manipulation;-webkit-font-smoothing:antialiased}
        #app{width:100%;max-width:414px;height:100vh;height:100dvh;background:var(--bg);color:var(--text);position:relative;display:flex;flex-direction:column;overflow:hidden}

        /* ===== Header ===== */
        header{padding:52px 20px 10px;display:flex;flex-direction:column;gap:10px;z-index:20;background:var(--bg);flex-shrink:0}
        .h-top{display:flex;justify-content:space-between;align-items:center;height:36px}
        .back{font-size:24px;cursor:pointer;display:none;padding:4px 14px 4px 0;color:var(--primary-bright);transition:opacity .2s;font-weight:300}
        .back:active{opacity:.4}
        .h-actions{display:none;gap:8px;align-items:center}
        .pill{background:var(--card);color:var(--text);border:1px solid var(--border);border-radius:20px;padding:7px 13px;font-size:11.5px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:5px;transition:all .2s;letter-spacing:.2px}
        .pill:active{transform:scale(.95);background:var(--card-hover)}
        .icon-btn{width:36px;height:36px;justify-content:center;padding:0;border-radius:50%;font-size:15px}
        .h-title-row{display:flex;justify-content:space-between;align-items:flex-end}
        h1{font-size:28px;font-weight:700;letter-spacing:-.5px}
        .h-sub{font-size:12.5px;color:var(--text-sub);margin-top:2px;display:none;letter-spacing:.2px}
        .gear{background:var(--card);border:1px solid var(--border);border-radius:50%;width:38px;height:38px;display:flex;justify-content:center;align-items:center;font-size:17px;cursor:pointer;transition:all .2s}
        .gear:active{transform:scale(.9)}

        /* ===== Views ===== */
        .view{flex:1;overflow-y:auto;padding:0 20px 110px;display:none;-webkit-overflow-scrolling:touch;scrollbar-width:none}
        .view::-webkit-scrollbar{display:none}
        .view.active{display:block;animation:fadeIn .3s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        .vw{padding-bottom:20px}

        /* ===== Delete Bar ===== */
        .del-bar{position:absolute;bottom:80px;left:0;width:100%;padding:12px 20px;background:linear-gradient(to top,var(--bg) 70%,transparent);z-index:30;transform:translateY(110%);transition:transform .35s cubic-bezier(.25,.8,.25,1)}
        .del-bar.show{transform:translateY(0)}
        .btn-del{width:100%;padding:15px;background:var(--danger-grad);color:#fff;border:none;border-radius:var(--r-md);font-size:14.5px;font-weight:700;cursor:pointer;box-shadow:0 6px 20px rgba(255,71,87,.3);display:flex;justify-content:center;align-items:center;gap:8px;transition:all .2s;letter-spacing:.3px}
        .btn-del:active{transform:scale(.97)}

        /* ===== Selectable Items ===== */
        .sel{position:relative;cursor:pointer;border:2.5px solid transparent;transition:all .25s cubic-bezier(.25,.46,.45,.94);overflow:hidden;background:var(--card)}
        .sel.checked{border-color:var(--danger);border-radius:14px!important}
        .sel.checked img{filter:brightness(.65)}
        .chk{position:absolute;bottom:8px;right:8px;width:24px;height:24px;border:2px solid rgba(255,255,255,.6);border-radius:7px;display:flex;justify-content:center;align-items:center;color:transparent;font-size:13px;font-weight:bold;transition:all .25s cubic-bezier(.34,1.56,.64,1);z-index:10;background:rgba(0,0,0,.35);backdrop-filter:blur(4px)}
        .sel.checked .chk{background:var(--danger);border-color:var(--danger);color:#fff;transform:scale(1.08);box-shadow:0 2px 8px rgba(255,71,87,.35)}
        .chk-circle{border-radius:50%}

        /* ===== Home ===== */
        .sto-row{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px}
        .sto-used{font-size:12.5px;color:var(--text-sub);letter-spacing:.2px}
        .sto-used strong{color:var(--primary-bright);font-weight:600}
        .sto-pct{font-size:11px;font-weight:700;color:var(--amber);background:rgba(255,177,66,.1);padding:3px 8px;border-radius:6px}
        .prog{width:100%;height:5px;background:rgba(255,255,255,.04);border-radius:3px;overflow:hidden}
        .prog-fill{width:0;height:100%;background:var(--primary-grad);border-radius:3px;transition:width 1.2s cubic-bezier(.25,.46,.45,.94)}
        .prog-fill.go{width:82%}
        .grid-home{display:grid;grid-template-columns:1fr 1fr;gap:13px;margin-top:22px}
        .g-card{border-radius:var(--r-lg);height:155px;position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-end;padding:15px;cursor:pointer;background-size:cover;background-position:center;transition:transform .2s;box-shadow:var(--shadow)}
        .g-card:active{transform:scale(.96)}
        .g-card::before{content:'';position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.88) 0%,rgba(0,0,0,.25) 55%,rgba(0,0,0,.08) 100%);z-index:1}
        .g-card>div{position:relative;z-index:2}
        .g-card.photos{background-image:url('https://images.unsplash.com/photo-1531306728370-53bfd6202e88?w=400&q=80')}
        .g-card.videos{background-image:url('https://images.unsplash.com/photo-1535016120720-40c68798625c?w=400&q=80')}
        .g-card.screenshots{background-image:url('https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=400&q=80')}
        .g-card.raw{background-image:url('https://images.unsplash.com/photo-1516807869374-4b53db6fcbf4?w=400&q=80')}
        .g-card h3{font-size:12.5px;font-weight:500;margin-bottom:2px;opacity:.7;letter-spacing:.3px}
        .g-card p{font-size:21px;font-weight:700;letter-spacing:-.3px}
        .g-card .cnt{font-size:10.5px;color:rgba(255,255,255,.45);margin-top:1px}

        /* ç¯€ç´„ãƒãƒŠãƒ¼ */
        .banner{background:linear-gradient(135deg,rgba(0,93,77,.14),rgba(0,137,110,.08));border:1px solid rgba(0,93,77,.2);border-radius:var(--r-md);padding:15px;margin-top:18px;display:flex;align-items:center;gap:12px}
        .banner-icon{width:42px;height:42px;background:var(--primary-grad);border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
        .banner h4{font-size:13.5px;font-weight:600;margin-bottom:2px}
        .banner p{font-size:11.5px;color:var(--text-sub);line-height:1.4}
        .pulse{display:inline-block;width:7px;height:7px;background:var(--primary-bright);border-radius:50%;margin-right:5px;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.8)}}

        /* ãƒ‡ãƒã‚¤ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ãƒãƒŠãƒ¼ */
        .access-banner{background:var(--card);border:1px dashed var(--border-active);border-radius:var(--r-md);padding:20px;margin-top:18px;text-align:center;cursor:pointer;transition:all .2s}
        .access-banner:active{transform:scale(.98);background:var(--card-hover)}
        .access-banner .ab-icon{font-size:32px;margin-bottom:10px}
        .access-banner h4{font-size:14px;font-weight:600;margin-bottom:4px}
        .access-banner p{font-size:11.5px;color:var(--text-sub);line-height:1.5}
        .access-banner .ab-btn{display:inline-block;margin-top:12px;background:var(--primary-grad);color:#fff;padding:10px 24px;border-radius:10px;font-size:13px;font-weight:700;letter-spacing:.3px}

        /* ===== Media Grid ===== */
        .m-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        .m-item{border-radius:var(--r-md);aspect-ratio:4/5;position:relative}
        .m-item img{width:100%;height:100%;object-fit:cover;display:block;border-radius:inherit;transition:filter .25s}
        .m-item{opacity:0;animation:pop .35s ease forwards}
        @keyframes pop{from{opacity:0;transform:scale(.93)}to{opacity:1;transform:scale(1)}}

        /* RAW */
        .raw-tag{position:absolute;top:8px;left:8px;background:var(--badge-bg);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.15);color:#fff;font-size:9px;font-weight:700;padding:3px 7px;border-radius:5px;z-index:2;letter-spacing:1.5px}
        .size-tag{position:absolute;bottom:8px;left:8px;background:var(--badge-bg);backdrop-filter:blur(6px);color:#fff;font-size:11.5px;font-weight:600;padding:4px 9px;border-radius:7px;z-index:2}

        /* ===== ä¼¼ã¦ã„ã‚‹å†™çœŸ ===== */
        .photo-group{margin-bottom:24px;background:var(--card);border:1px solid var(--border);border-radius:var(--r-lg);padding:14px;transition:all .3s}
        .grp-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        .grp-title{font-size:14px;font-weight:600;display:flex;align-items:center;gap:8px}
        .grp-count{font-size:11px;color:var(--text-sub);background:rgba(0,93,77,.12);padding:2px 8px;border-radius:5px;font-weight:500}
        .grp-actions{display:flex;gap:6px}
        .grp-pill{background:rgba(255,255,255,.06);border:1px solid var(--border);color:var(--text-sub);font-size:10.5px;font-weight:600;padding:5px 10px;border-radius:8px;cursor:pointer;transition:all .2s}
        .grp-pill:active{transform:scale(.95)}
        .grp-pill.active{background:var(--primary);border-color:var(--primary);color:#fff}

        /* ãƒ™ã‚¹ãƒˆãƒãƒƒã‚¸ */
        .best{position:absolute;bottom:8px;left:8px;background:rgba(0,93,77,.85);backdrop-filter:blur(6px);font-size:10.5px;font-weight:700;padding:5px 10px;border-radius:8px;display:flex;align-items:center;gap:4px;z-index:2;color:var(--primary-bright);letter-spacing:.3px}
        .best::before{content:'âœ¦';font-size:11px}
        /* ã‚­ãƒ¼ãƒ—ãƒãƒƒã‚¸ - ãƒ™ã‚¹ãƒˆå†™çœŸã«è¡¨ç¤º */
        .keep-overlay{position:absolute;top:8px;right:8px;background:rgba(0,184,148,.2);border:1px solid rgba(0,184,148,.4);color:var(--primary-bright);font-size:9.5px;font-weight:700;padding:3px 8px;border-radius:6px;z-index:2;letter-spacing:.5px}

        /* å‹•ç”» */
        .v-item{aspect-ratio:1/1}
        .v-badge{position:absolute;bottom:8px;left:8px;background:rgba(0,93,77,.88);backdrop-filter:blur(6px);border-radius:8px;padding:5px 9px;display:flex;flex-direction:column;z-index:2}
        .v-badge .sz{font-size:13px;font-weight:700;color:#fff;line-height:1.2}
        .v-badge .dur{font-size:10px;color:rgba(255,255,255,.7);line-height:1.3;font-weight:500}
        .play{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:38px;height:38px;background:rgba(0,0,0,.45);backdrop-filter:blur(4px);border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:2;font-size:14px;opacity:.75}

        /* ===== Empty State ===== */
        .empty{display:none;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center;animation:fadeIn .5s ease}
        .empty .e-icon{width:76px;height:76px;background:linear-gradient(135deg,rgba(0,93,77,.18),rgba(0,184,148,.08));border:1px solid rgba(0,93,77,.18);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:34px;margin-bottom:18px}
        .empty h3{font-size:17px;font-weight:600;margin-bottom:5px}
        .empty p{font-size:12.5px;color:var(--text-sub);line-height:1.5}

        /* ===== Toast ===== */
        .toast{position:absolute;top:56px;left:16px;right:16px;background:var(--card);border:1px solid var(--border-active);border-radius:var(--r-md);padding:13px 15px;display:flex;justify-content:space-between;align-items:center;z-index:100;box-shadow:0 12px 40px rgba(0,0,0,.5);transform:translateY(-130%);transition:transform .4s cubic-bezier(.25,.8,.25,1);backdrop-filter:blur(20px)}
        .toast.show{transform:translateY(0)}
        .toast-t{font-size:12.5px;font-weight:500}
        .toast-t strong{color:var(--danger)}
        .toast-u{background:none;border:none;color:var(--primary-bright);font-size:12.5px;font-weight:700;cursor:pointer;padding:4px 8px}
        .toast-u:active{opacity:.5}

        /* ===== Modal ===== */
        .modal{position:absolute;inset:0;background:rgba(0,0,0,.55);z-index:200;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s}
        .modal.show{opacity:1;pointer-events:all}
        .modal-s{width:100%;max-width:414px;background:var(--card);border-radius:20px 20px 0 0;padding:22px 20px 38px;transform:translateY(100%);transition:transform .35s cubic-bezier(.25,.8,.25,1)}
        .modal.show .modal-s{transform:translateY(0)}
        .modal-h{width:36px;height:4px;background:rgba(0,93,77,.25);border-radius:2px;margin:0 auto 18px}
        .modal-title{font-size:16px;font-weight:700;text-align:center;margin-bottom:5px}
        .modal-desc{font-size:12.5px;color:var(--text-sub);text-align:center;margin-bottom:22px;line-height:1.5}
        .m-btn{width:100%;padding:14px;border:none;border-radius:var(--r-md);font-size:14.5px;font-weight:700;cursor:pointer;margin-bottom:8px;transition:all .2s}
        .m-btn:active{transform:scale(.97)}
        .m-btn.dng{background:var(--danger-grad);color:#fff}
        .m-btn.can{background:rgba(255,255,255,.06);color:var(--text)}

        /* ===== Sort ===== */
        .sort-bar{display:none;justify-content:space-between;align-items:center;margin-bottom:12px}
        .sort-bar.show{display:flex}
        .sort-lbl{font-size:11px;color:var(--text-sub)}
        .sort-opts{display:flex;gap:5px}
        .sort-c{background:var(--card);border:1px solid var(--border);color:var(--text-sub);font-size:10.5px;font-weight:600;padding:5px 10px;border-radius:7px;cursor:pointer;transition:all .2s}
        .sort-c.on{background:var(--primary);border-color:var(--primary);color:#fff}
        .sort-c:active{transform:scale(.95)}

        /* ===== Nav ===== */
        nav{position:absolute;bottom:0;left:0;width:100%;height:78px;background:rgba(4,16,14,.94);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);display:flex;justify-content:space-around;align-items:center;padding-bottom:18px;border-top:1px solid var(--border);z-index:40}
        .nav-i{display:flex;flex-direction:column;align-items:center;color:var(--text-dim);font-size:10px;cursor:pointer;transition:color .25s;padding:4px 14px;font-weight:500}
        .nav-i.on{color:var(--primary-bright)}
        .nav-ic{font-size:23px;margin-bottom:2px}
        .nav-dot{width:4px;height:4px;border-radius:50%;background:var(--primary-bright);margin-top:2px;opacity:0;transition:opacity .25s}
        .nav-i.on .nav-dot{opacity:1}

        /* ===== File Input (hidden) ===== */
        .file-in{display:none}
    </style>
</head>
<body>

<div id="app">
    <header>
        <div class="h-top">
            <div id="back" class="back" onclick="go('home')">â€¹</div>
            <div id="actions" class="h-actions">
                <button class="pill icon-btn" id="sort-btn" onclick="toggleSort()" title="ã‚½ãƒ¼ãƒˆ">â‡…</button>
                <button class="pill" id="sel-all-btn" onclick="toggleSelectAll()">â˜‘ ã™ã¹ã¦é¸æŠ</button>
            </div>
            <div id="gear" class="gear">âš™</div>
        </div>
        <div class="h-title-row">
            <div>
                <h1 id="title">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h1>
                <div id="sub" class="h-sub"></div>
            </div>
        </div>
    </header>

    <!-- ãƒ›ãƒ¼ãƒ  -->
    <main id="home" class="view active">
        <div class="vw">
            <div class="sto-row">
                <div class="sto-used"><strong>1,640 GB</strong> / 2,000 GB</div>
                <div class="sto-pct">82%</div>
            </div>
            <div class="prog"><div class="prog-fill" id="prog"></div></div>

            <div class="grid-home">
                <div class="g-card photos" onclick="go('similar')">
                    <div><h3>ä¼¼ã¦ã„ã‚‹å†™çœŸ</h3><p>24.4 GB</p><div class="cnt">1,088 æš</div></div>
                </div>
                <div class="g-card videos" onclick="go('videos')">
                    <div><h3>å‹•ç”»ã‚’æ•´ç†</h3><p>299 GB</p><div class="cnt">660 æœ¬</div></div>
                </div>
                <div class="g-card raw" onclick="go('raw')">
                    <div><h3>RAWãƒ‡ãƒ¼ã‚¿</h3><p>128 GB</p><div class="cnt">3,711 å€‹</div></div>
                </div>
                <div class="g-card screenshots" onclick="go('ss')">
                    <div><h3>ã‚¹ã‚¯ã‚·ãƒ§</h3><p>193 MB</p><div class="cnt">78 æš</div></div>
                </div>
            </div>

            <div class="banner">
                <div class="banner-icon">ğŸ§¹</div>
                <div>
                    <h4><span class="pulse"></span>æœ€å¤§ 451 GB ç¯€ç´„å¯èƒ½</h4>
                    <p>ä¸è¦ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã¦ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å–ã‚Šæˆ»ãã†</p>
                </div>
            </div>

            <div class="access-banner" onclick="document.getElementById('file-input').click()">
                <div class="ab-icon">ğŸ“±</div>
                <h4>ãƒ‡ãƒã‚¤ã‚¹ã®å†™çœŸã‚’èª­ã¿è¾¼ã‚€</h4>
                <p>ç«¯æœ«ã®ã‚«ãƒ¡ãƒ©ãƒ­ãƒ¼ãƒ«ã‹ã‚‰å†™çœŸã‚’é¸æŠã—ã¦<br>é‡è¤‡ãƒ»ä¸è¦ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã§ãã¾ã™</p>
                <div class="ab-btn">å†™çœŸã‚’é¸æŠ</div>
            </div>
            <input type="file" id="file-input" class="file-in" accept="image/*" multiple onchange="handleFiles(this.files)">
        </div>
    </main>

    <!-- RAW -->
    <main id="raw" class="view">
        <div class="vw">
            <div id="raw-sort" class="sort-bar">
                <span class="sort-lbl">ä¸¦ã³æ›¿ãˆ:</span>
                <div class="sort-opts">
                    <div class="sort-c on" onclick="sortView('raw','desc',this)">å¤§ãã„é †</div>
                    <div class="sort-c" onclick="sortView('raw','asc',this)">å°ã•ã„é †</div>
                </div>
            </div>
            <div id="raw-grid" class="m-grid"></div>
            <div id="raw-empty" class="empty"><div class="e-icon">âœ¨</div><h3>ã™ã¹ã¦ã‚¯ãƒªãƒ¼ãƒ³ï¼</h3><p>RAWãƒ‡ãƒ¼ã‚¿ã¯æ•´ç†æ¸ˆã¿ã§ã™</p></div>
        </div>
    </main>

    <!-- ä¼¼ã¦ã„ã‚‹å†™çœŸ -->
    <main id="similar" class="view">
        <div class="vw" id="sim-wrap"></div>
        <div id="sim-empty" class="empty"><div class="e-icon">âœ¨</div><h3>ã™ã¹ã¦ã‚¯ãƒªãƒ¼ãƒ³ï¼</h3><p>é‡è¤‡å†™çœŸã¯æ•´ç†æ¸ˆã¿ã§ã™</p></div>
    </main>

    <!-- å‹•ç”» -->
    <main id="videos" class="view">
        <div class="vw">
            <div id="vid-sort" class="sort-bar">
                <span class="sort-lbl">ä¸¦ã³æ›¿ãˆ:</span>
                <div class="sort-opts">
                    <div class="sort-c on" onclick="sortView('videos','desc',this)">å¤§ãã„é †</div>
                    <div class="sort-c" onclick="sortView('videos','asc',this)">å°ã•ã„é †</div>
                </div>
            </div>
            <div id="vid-grid" class="m-grid"></div>
            <div id="vid-empty" class="empty"><div class="e-icon">âœ¨</div><h3>ã™ã¹ã¦ã‚¯ãƒªãƒ¼ãƒ³ï¼</h3><p>å‹•ç”»ã¯æ•´ç†æ¸ˆã¿ã§ã™</p></div>
        </div>
    </main>

    <!-- ã‚¹ã‚¯ã‚·ãƒ§ -->
    <main id="ss" class="view">
        <div class="vw">
            <div id="ss-grid" class="m-grid"></div>
            <div id="ss-empty" class="empty"><div class="e-icon">âœ¨</div><h3>ã™ã¹ã¦ã‚¯ãƒªãƒ¼ãƒ³ï¼</h3><p>ã‚¹ã‚¯ã‚·ãƒ§ã¯æ•´ç†æ¸ˆã¿ã§ã™</p></div>
        </div>
    </main>

    <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼å†™çœŸ -->
    <main id="user-photos" class="view">
        <div class="vw">
            <div id="user-grid" class="m-grid"></div>
            <div id="user-empty" class="empty" style="display:flex"><div class="e-icon">ğŸ“·</div><h3>å†™çœŸã‚’é¸æŠã—ã¦ãã ã•ã„</h3><p>ãƒ›ãƒ¼ãƒ ç”»é¢ã‹ã‚‰å†™çœŸã‚’èª­ã¿è¾¼ã‚ã¾ã™</p></div>
        </div>
    </main>

    <!-- å‰Šé™¤ãƒãƒ¼ -->
    <div id="del-bar" class="del-bar">
        <button class="btn-del" onclick="confirmDel()">
            <span>ğŸ—‘</span><span id="del-text">å‰Šé™¤</span>
        </button>
    </div>

    <!-- ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="modal" class="modal" onclick="if(event.target===this)hideModal()">
        <div class="modal-s">
            <div class="modal-h"></div>
            <div class="modal-title" id="m-title">å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</div>
            <div class="modal-desc" id="m-desc">ã‚´ãƒŸç®±ã«ç§»å‹•ã•ã‚Œã¾ã™ã€‚</div>
            <button class="m-btn dng" onclick="execDel()">å‰Šé™¤ã™ã‚‹</button>
            <button class="m-btn can" onclick="hideModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        </div>
    </div>

    <!-- Undo -->
    <div id="toast" class="toast">
        <span class="toast-t" id="toast-t"></span>
        <button class="toast-u" onclick="undo()">å…ƒã«æˆ»ã™</button>
    </div>

    <!-- ãƒŠãƒ“ -->
    <nav>
        <div class="nav-i on" data-t="home"><div class="nav-ic">ğŸ </div><span>ãƒ›ãƒ¼ãƒ </span><div class="nav-dot"></div></div>
        <div class="nav-i"><div class="nav-ic">âœ‰ï¸</div><span>ãƒ¡ãƒ¼ãƒ«</span><div class="nav-dot"></div></div>
        <div class="nav-i"><div class="nav-ic">ğŸš€</div><span>ãƒ–ãƒ¼ã‚¹ãƒˆ</span><div class="nav-dot"></div></div>
    </nav>
</div>

<script>
// ========== Data ==========
const rawData = [
    { id:'r1', src:'https://images.unsplash.com/photo-1621360841013-c76831f1a301?w=300&q=80', mb:45.2 },
    { id:'r2', src:'https://images.unsplash.com/photo-1600607688969-a5bfcd64fd28?w=300&q=80', mb:38.7 },
    { id:'r3', src:'https://images.unsplash.com/photo-1588612143431-7e87ab06d71b?w=300&q=80', mb:52.1 },
    { id:'r4', src:'https://images.unsplash.com/photo-1549608276-5786777e6587?w=300&q=80', mb:41.5 },
    { id:'r5', src:'https://images.unsplash.com/photo-1551373884-8a0750074df7?w=300&q=80', mb:48.9 },
    { id:'r6', src:'https://images.unsplash.com/photo-1534447677768-be436bb09401?w=300&q=80', mb:39.2 }
];

// ä¼¼ã¦ã„ã‚‹å†™çœŸã‚°ãƒ«ãƒ¼ãƒ—: photos[0] = ãƒ™ã‚¹ãƒˆ, photos[1+] = å‰Šé™¤å€™è£œï¼ˆæœ€åˆã‹ã‚‰ãƒã‚§ãƒƒã‚¯ï¼‰
const simGroups = [
    { id:'g1', photos:[
        { id:'s1a', src:'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80', mb:2.6, best:true },
        { id:'s1b', src:'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80&blur=2', mb:2.6, best:false },
        { id:'s1c', src:'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80&sepia=1', mb:2.4, best:false }
    ]},
    { id:'g2', photos:[
        { id:'s2a', src:'https://images.unsplash.com/photo-1531306728370-53bfd6202e88?w=300&q=80', mb:4.2, best:true },
        { id:'s2b', src:'https://images.unsplash.com/photo-1531306728370-53bfd6202e88?w=300&q=80&sepia=1', mb:4.2, best:false }
    ]},
    { id:'g3', photos:[
        { id:'s3a', src:'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80', mb:3.8, best:true },
        { id:'s3b', src:'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80&blur=3', mb:3.6, best:false },
        { id:'s3c', src:'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80&sepia=1', mb:3.5, best:false }
    ]}
];

const vidData = [
    { id:'v1', src:'https://images.unsplash.com/photo-1520697921389-9a2f647035ce?w=300&q=80', gb:6.86, dur:'07:54' },
    { id:'v2', src:'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80', gb:4.06, dur:'05:37' },
    { id:'v3', src:'https://images.unsplash.com/photo-1504274066651-8d31a536b11a?w=300&q=80', gb:3.52, dur:'04:44' },
    { id:'v4', src:'https://images.unsplash.com/photo-1511895426328-dc8714191300?w=300&q=80', gb:3.38, dur:'05:46' }
];

const ssData = [
    { id:'ss1', src:'https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=300&q=80' },
    { id:'ss2', src:'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=300&q=80' },
    { id:'ss3', src:'https://images.unsplash.com/photo-1531306728370-53bfd6202e88?w=300&q=80' },
    { id:'ss4', src:'https://images.unsplash.com/photo-1511895426328-dc8714191300?w=300&q=80' }
];

// ========== State ==========
let tab = 'home';
let allSel = false;
let undoData = [];
let undoTab = '';
let tTimer = null;

// ========== Init ==========
document.addEventListener('DOMContentLoaded', () => {
    renderRaw();
    renderSimilar();
    renderVid();
    renderSS();
    go('home');
    requestAnimationFrame(() => setTimeout(() => document.getElementById('prog').classList.add('go'), 150));
    document.querySelectorAll('.nav-i').forEach(n => n.addEventListener('click', e => {
        const t = e.currentTarget.dataset.t;
        if (t) { document.querySelectorAll('.nav-i').forEach(x => x.classList.remove('on')); e.currentTarget.classList.add('on'); go(t); }
    }));
});

// ========== Render ==========
function renderRaw() {
    document.getElementById('raw-grid').innerHTML = rawData.map((p,i) => `
        <div class="m-item sel" data-sz="${p.mb}" onclick="toggle(this)" style="animation-delay:${i*.05}s">
            <img src="${p.src}" loading="lazy"><div class="raw-tag">RAW</div>
            <div class="size-tag">${p.mb} MB</div><div class="chk">âœ“</div>
        </div>`).join('');
}

function renderSimilar() {
    const w = document.getElementById('sim-wrap');
    w.innerHTML = simGroups.map((g, gi) => {
        const total = g.photos.reduce((a,p) => a + p.mb, 0).toFixed(1);
        const nonBest = g.photos.filter(p => !p.best).length;
        const rows = g.photos.map((p, pi) => `
            <div class="m-item sel${p.best ? '' : ' checked'}" data-sz="${p.mb}" data-grp="${g.id}" onclick="toggle(this)" style="animation-delay:${(gi*3+pi)*.05}s">
                ${p.best ? '<div class="keep-overlay">KEEP</div><div class="best">ãƒ™ã‚¹ãƒˆ</div>' : ''}
                <img src="${p.src}" loading="lazy">
                <div class="chk chk-circle">âœ“</div>
            </div>`).join('');
        return `
            <div class="photo-group" data-gid="${g.id}">
                <div class="grp-header">
                    <div class="grp-title">${g.photos.length} æšãŒé¡ä¼¼ <span class="grp-count">${total} MB</span></div>
                    <div class="grp-actions">
                        <div class="grp-pill${nonBest === g.photos.filter(p=>!p.best).length ? ' active' : ''}" onclick="grpSelectNonBest('${g.id}',this)">ãƒ™ã‚¹ãƒˆä»¥å¤–ã‚’é¸æŠ</div>
                        <div class="grp-pill" onclick="grpSelectAll('${g.id}',this)">ã™ã¹ã¦é¸æŠ</div>
                    </div>
                </div>
                <div class="m-grid">${rows}</div>
            </div>`;
    }).join('');
}

function renderVid() {
    document.getElementById('vid-grid').innerHTML = vidData.map((v,i) => `
        <div class="m-item v-item sel" data-sz="${v.gb*1000}" onclick="toggle(this)" style="animation-delay:${i*.05}s">
            <img src="${v.src}" loading="lazy"><div class="play">â–¶</div>
            <div class="v-badge"><span class="sz">${v.gb} GB</span><span class="dur">${v.dur}</span></div>
            <div class="chk">âœ“</div>
        </div>`).join('');
}

function renderSS() {
    document.getElementById('ss-grid').innerHTML = ssData.map((s,i) => `
        <div class="m-item sel${i < 2 ? ' checked' : ''}" data-sz="2.5" onclick="toggle(this)" style="animation-delay:${i*.05}s">
            <img src="${s.src}" loading="lazy"><div class="chk">âœ“</div>
        </div>`).join('');
}

// ========== Navigation ==========
function go(id) {
    tab = id;
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    const t = document.getElementById('title');
    const s = document.getElementById('sub');
    const bk = document.getElementById('back');
    const ac = document.getElementById('actions');
    const gr = document.getElementById('gear');
    const db = document.getElementById('del-bar');

    s.style.display = 'block'; bk.style.display = 'block'; ac.style.display = 'flex'; gr.style.display = 'none';
    db.classList.remove('show'); hideSorts();

    const cfg = {
        home:    { t:'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸', s:'', home:true },
        raw:     { t:'RAWãƒ‡ãƒ¼ã‚¿', s:'3,711 å€‹ Â· 128 GB' },
        similar: { t:'ä¼¼ã¦ã„ã‚‹å†™çœŸ', s:'1,088 æš Â· 24.4 GB' },
        videos:  { t:'å‹•ç”»ã‚’æ•´ç†', s:'660 æœ¬ Â· 299 GB' },
        ss:      { t:'ã‚¹ã‚¯ã‚·ãƒ§', s:'78 æš Â· 193 MB' },
        'user-photos': { t:'èª­ã¿è¾¼ã‚“ã å†™çœŸ', s:'' }
    };
    const c = cfg[id];
    t.innerText = c.t;
    if (c.home) {
        s.style.display = 'none'; bk.style.display = 'none'; ac.style.display = 'none'; gr.style.display = 'flex';
        document.querySelectorAll('.nav-i').forEach(n => n.classList.remove('on'));
        document.querySelector('.nav-i[data-t="home"]').classList.add('on');
    } else {
        s.innerText = c.s;
        checkAll(); updateDel(); checkEmpty(id);
    }
}

// ========== Selection ==========
function toggle(el) {
    el.classList.toggle('checked');
    checkAll(); updateDel();
    // ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒœã‚¿ãƒ³çŠ¶æ…‹ã‚‚æ›´æ–°
    const grp = el.dataset.grp;
    if (grp) updateGrpBtns(grp);
}

function toggleSelectAll() {
    const v = document.querySelector('.view.active');
    const items = v.querySelectorAll('.sel');
    allSel = !allSel;
    items.forEach(i => i.classList.toggle('checked', allSel));
    updateSelBtn(); updateDel();
    // å…¨ã‚°ãƒ«ãƒ¼ãƒ—ãƒœã‚¿ãƒ³æ›´æ–°
    document.querySelectorAll('.photo-group').forEach(g => updateGrpBtns(g.dataset.gid));
}

function checkAll() {
    const v = document.querySelector('.view.active');
    const tot = v.querySelectorAll('.sel').length;
    const sel = v.querySelectorAll('.sel.checked').length;
    allSel = tot > 0 && tot === sel;
    updateSelBtn();
}

function updateSelBtn() {
    document.getElementById('sel-all-btn').innerHTML = allSel ? 'âŠ˜ é¸æŠè§£é™¤' : 'â˜‘ ã™ã¹ã¦é¸æŠ';
}

// ========== ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ã®é¸æŠ ==========
function grpSelectNonBest(gid, btn) {
    const grp = document.querySelector(`.photo-group[data-gid="${gid}"]`);
    const items = grp.querySelectorAll('.sel');
    items.forEach(item => {
        const hasBest = item.querySelector('.best');
        item.classList.toggle('checked', !hasBest);
    });
    checkAll(); updateDel(); updateGrpBtns(gid);
}

function grpSelectAll(gid, btn) {
    const grp = document.querySelector(`.photo-group[data-gid="${gid}"]`);
    const items = grp.querySelectorAll('.sel');
    const allChecked = [...items].every(i => i.classList.contains('checked'));
    items.forEach(i => i.classList.toggle('checked', !allChecked));
    checkAll(); updateDel(); updateGrpBtns(gid);
}

function updateGrpBtns(gid) {
    const grp = document.querySelector(`.photo-group[data-gid="${gid}"]`);
    if (!grp) return;
    const items = grp.querySelectorAll('.sel');
    const btns = grp.querySelectorAll('.grp-pill');
    // ãƒ™ã‚¹ãƒˆä»¥å¤–ãƒœã‚¿ãƒ³çŠ¶æ…‹
    const nonBestItems = [...items].filter(i => !i.querySelector('.best'));
    const allNonBestChecked = nonBestItems.length > 0 && nonBestItems.every(i => i.classList.contains('checked'));
    const bestItem = [...items].find(i => i.querySelector('.best'));
    const bestNotChecked = bestItem && !bestItem.classList.contains('checked');
    btns[0].classList.toggle('active', allNonBestChecked && bestNotChecked);
    // ã™ã¹ã¦é¸æŠãƒœã‚¿ãƒ³çŠ¶æ…‹
    const allChecked = [...items].every(i => i.classList.contains('checked'));
    btns[1].classList.toggle('active', allChecked);
}

// ========== Delete Bar ==========
function updateDel() {
    const v = document.querySelector('.view.active');
    const sel = v.querySelectorAll('.sel.checked');
    const cnt = sel.length;
    const bar = document.getElementById('del-bar');
    const txt = document.getElementById('del-text');
    if (cnt > 0) {
        let mb = 0; sel.forEach(i => mb += parseFloat(i.dataset.sz || 0));
        const sz = mb < 1000 ? `${mb.toFixed(1)} MB` : `${(mb/1000).toFixed(2)} GB`;
        const labels = { raw:'RAWãƒ‡ãƒ¼ã‚¿', similar:'é¡ä¼¼å†™çœŸ', ss:'ã‚¹ã‚¯ã‚·ãƒ§', videos:'å‹•ç”»', 'user-photos':'å†™çœŸ' };
        txt.innerText = `${cnt} ä»¶ã®${labels[tab]||'ã‚¢ã‚¤ãƒ†ãƒ '}ã‚’å‰Šé™¤ Â· ${sz}`;
        bar.classList.add('show');
    } else bar.classList.remove('show');
}

// ========== Delete Flow ==========
function confirmDel() {
    const v = document.querySelector('.view.active');
    const cnt = v.querySelectorAll('.sel.checked').length;
    if (!cnt) return;
    let mb = 0; v.querySelectorAll('.sel.checked').forEach(i => mb += parseFloat(i.dataset.sz||0));
    const sz = mb < 1000 ? `${mb.toFixed(1)} MB` : `${(mb/1000).toFixed(2)} GB`;
    document.getElementById('m-title').innerText = `${cnt} ä»¶ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
    document.getElementById('m-desc').innerText = `${sz} ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒè§£æ”¾ã•ã‚Œã¾ã™ã€‚\n30æ—¥é–“ã¯ã‚´ãƒŸç®±ã‹ã‚‰å¾©å…ƒã§ãã¾ã™ã€‚`;
    document.getElementById('modal').classList.add('show');
}

function hideModal() { document.getElementById('modal').classList.remove('show'); }

function execDel() {
    hideModal();
    const v = document.querySelector('.view.active');
    const sel = v.querySelectorAll('.sel.checked');
    undoData = []; undoTab = tab;
    sel.forEach(i => undoData.push({ html:i.outerHTML, parent:i.parentElement, next:i.nextElementSibling }));
    const cnt = sel.length;
    sel.forEach((item, i) => {
        item.style.transition = 'all .3s ease';
        item.style.transitionDelay = `${i*.03}s`;
        item.style.transform = 'scale(.5)'; item.style.opacity = '0';
    });
    setTimeout(() => {
        sel.forEach(i => i.remove());
        updateDel(); checkAll(); checkEmpty(tab); cleanGroups();
    }, 300 + sel.length * 30);
    showToast(cnt);
}

// ========== Empty / Cleanup ==========
function checkEmpty(id) {
    const map = { raw:'raw-empty', videos:'vid-empty', ss:'ss-empty', similar:'sim-empty', 'user-photos':'user-empty' };
    const eid = map[id]; if (!eid) return;
    const v = document.getElementById(id);
    const items = v.querySelectorAll('.sel');
    const el = document.getElementById(eid);
    if (items.length === 0) { el.style.display = 'flex'; document.getElementById('actions').style.display = 'none'; }
    else el.style.display = 'none';
}

function cleanGroups() {
    document.querySelectorAll('.photo-group').forEach(g => {
        if (g.querySelectorAll('.sel').length === 0) {
            g.style.transition = 'all .3s'; g.style.opacity = '0'; g.style.maxHeight = '0'; g.style.marginBottom = '0'; g.style.padding = '0'; g.style.overflow = 'hidden';
            setTimeout(() => g.remove(), 300);
        }
    });
}

// ========== Undo ==========
function showToast(cnt) {
    const t = document.getElementById('toast');
    document.getElementById('toast-t').innerHTML = `<strong>${cnt} ä»¶</strong> å‰Šé™¤ã—ã¾ã—ãŸ`;
    t.classList.add('show');
    clearTimeout(tTimer);
    tTimer = setTimeout(() => { t.classList.remove('show'); undoData = []; }, 5000);
}

function undo() {
    if (!undoData.length) return;
    undoData.reverse().forEach(d => {
        const tmp = document.createElement('div'); tmp.innerHTML = d.html;
        const el = tmp.firstElementChild;
        el.style.cssText = '';
        if (d.next) d.parent.insertBefore(el, d.next); else d.parent.appendChild(el);
    });
    undoData = [];
    document.getElementById('toast').classList.remove('show');
    clearTimeout(tTimer);
    checkEmpty(undoTab); checkAll(); updateDel();
    if (tab !== 'home') document.getElementById('actions').style.display = 'flex';
}

// ========== Sort ==========
function toggleSort() {
    const map = { raw:'raw-sort', videos:'vid-sort' };
    const id = map[tab]; if (!id) return;
    document.getElementById(id).classList.toggle('show');
}
function hideSorts() { document.querySelectorAll('.sort-bar').forEach(b => b.classList.remove('show')); }
function sortView(tabId, dir, chip) {
    chip.parentElement.querySelectorAll('.sort-c').forEach(c => c.classList.remove('on'));
    chip.classList.add('on');
    const gMap = { raw:'raw-grid', videos:'vid-grid' };
    const grid = document.getElementById(gMap[tabId]);
    const items = [...grid.querySelectorAll('.sel')];
    items.sort((a,b) => dir==='desc' ? parseFloat(b.dataset.sz)-parseFloat(a.dataset.sz) : parseFloat(a.dataset.sz)-parseFloat(b.dataset.sz));
    grid.innerHTML = '';
    items.forEach((it,i) => { it.style.animation = `pop .3s ease ${i*.04}s forwards`; it.style.opacity = '0'; grid.appendChild(it); });
}

// ========== File Upload ==========
function handleFiles(files) {
    if (!files.length) return;
    const grid = document.getElementById('user-grid');
    const empty = document.getElementById('user-empty');
    empty.style.display = 'none';
    
    [...files].forEach((file, i) => {
        const reader = new FileReader();
        reader.onload = e => {
            const sizeMB = (file.size / 1024 / 1024).toFixed(1);
            const div = document.createElement('div');
            div.className = 'm-item sel';
            div.dataset.sz = sizeMB;
            div.style.animationDelay = `${i * .05}s`;
            div.onclick = function(){ toggle(this); };
            div.innerHTML = `<img src="${e.target.result}"><div class="size-tag">${sizeMB} MB</div><div class="chk">âœ“</div>`;
            grid.appendChild(div);
        };
        reader.readAsDataURL(file);
    });
    
    setTimeout(() => go('user-photos'), 300);
}
</script>
</body>
</html>
