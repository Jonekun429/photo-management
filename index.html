<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cleaner Pro - Green Theme & 15 Months MVP</title>
    <style>
        :root {
            /* ãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ #005D4D ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ãŸãƒ†ãƒ¼ãƒ */
            --primary: #005D4D;
            --primary-light: #00896e;
            --accent: #00b894;
            --bg: #04100e;
            --surface: #0c1f1b;
            --surface-hover: #153029;
            --text-main: #ffffff;
            --text-sub: #8db5ab;
            --danger: #ff4757;
            --warn: #ffb142;
            --border: rgba(0, 184, 148, 0.15);
            --radius-l: 24px;
            --radius-m: 16px;
            --radius-s: 12px;
            --shadow: 0 8px 24px rgba(0,0,0,0.4);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Hiragino Sans", "Helvetica Neue", sans-serif;
        }

        /* Reset & Base */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { background: #000; display: flex; justify-content: center; touch-action: manipulation; -webkit-font-smoothing: antialiased; color: var(--text-main); }
        #app { width: 100%; max-width: 414px; height: 100vh; height: 100dvh; background: var(--bg); position: relative; display: flex; flex-direction: column; overflow: hidden; }

        /* Typography */
        h1 { font-size: 28px; font-weight: 800; letter-spacing: 0.5px; }
        h2 { font-size: 20px; font-weight: 700; }
        p { font-size: 14px; color: var(--text-sub); line-height: 1.5; }

        /* Header */
        header { padding: 50px 20px 10px; display: flex; justify-content: space-between; align-items: center; z-index: 20; background: var(--bg); flex-shrink: 0; }
        .h-actions { display: flex; gap: 12px; }
        .btn-icon { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; color: var(--accent); font-size: 18px; cursor: pointer; }

        /* View Container */
        .view { flex: 1; overflow-y: auto; padding: 10px 20px 110px; display: none; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
        .view::-webkit-scrollbar { display: none; }
        .view.active { display: block; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px) } to { opacity: 1; transform: translateY(0) } }

        /* --- Home View --- */
        .storage-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px; }
        .storage-used { font-size: 13px; color: var(--text-sub); font-weight: 600; }
        .storage-used strong { color: var(--accent); font-size: 16px; }
        .storage-pct { font-size: 12px; color: var(--text-main); font-weight: 600; background: rgba(0,184,148,0.15); padding: 4px 8px; border-radius: 6px; }
        .progress-bar { width: 100%; height: 6px; background: var(--surface); border-radius: 4px; margin-bottom: 24px; overflow: hidden; border: 1px solid var(--border); }
        .progress-fill { height: 100%; width: 26%; background: linear-gradient(90deg, var(--primary), var(--accent)); border-radius: 4px; transition: width 1s ease; }

        .home-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { border-radius: var(--radius-l); position: relative; overflow: hidden; cursor: pointer; background-size: cover; background-position: center; box-shadow: var(--shadow); transition: transform 0.2s; border: 1px solid rgba(0, 184, 148, 0.2); }
        .card:active { transform: scale(0.97); }
        .card::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.2) 60%, rgba(0,0,0,0) 100%); z-index: 1; pointer-events: none; }
        .card-content { position: absolute; bottom: 18px; left: 16px; right: 16px; z-index: 2; }
        .card h3 { font-size: 14px; font-weight: 600; margin-bottom: 2px; text-shadow: 0 2px 4px rgba(0,0,0,0.8); color: rgba(255,255,255,0.9); }
        .card .size { font-size: 24px; font-weight: 800; text-shadow: 0 2px 4px rgba(0,0,0,0.8); letter-spacing: -0.5px; color: #fff; }

        .c-sim { height: 240px; background-image: url('https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=400&q=80'); grid-row: span 2; }
        .c-vid { height: 260px; background-image: url('https://images.unsplash.com/photo-1600607688969-a5bfcd64fd28?w=400&q=80'); }
        .c-sim-vid { height: 180px; background-image: url('https://images.unsplash.com/photo-1506157786151-b8491531f063?w=400&q=80'); }
        .c-ss { height: 160px; background-color: #ffffff; background-image: url('https://images.unsplash.com/photo-1611162617474-5b21e879e113?w=400&q=80'); background-blend-mode: overlay; }
        .c-ss::after { background: linear-gradient(to top, rgba(255,255,255,1) 0%, rgba(255,255,255,0.4) 60%, rgba(255,255,255,0) 100%); }
        .c-ss h3 { color: #555; text-shadow: none; }
        .c-ss .size { color: #000; text-shadow: none; }

        /* --- Swipe View --- */
        .stats-header { display: flex; gap: 12px; margin-bottom: 24px; }
        .stat-box { flex: 1; background: var(--surface); border-radius: var(--radius-m); padding: 16px; display: flex; align-items: center; gap: 14px; border: 1px solid var(--border); }
        .stat-icon { font-size: 28px; }
        .stat-label { font-size: 11px; color: var(--text-sub); margin-bottom: 2px; font-weight: 600; }
        .stat-val { font-size: 17px; font-weight: 800; color: var(--accent); }

        .month-list { display: flex; flex-direction: column; gap: 14px; }
        .m-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 16px; display: flex; gap: 16px; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .m-card:active { transform: scale(0.98); background: var(--surface-hover); }
        .m-thumb { width: 68px; height: 68px; border-radius: 12px; background-size: cover; background-position: center; position: relative; flex-shrink: 0; }
        .m-thumb.done::after { content: 'âœ“'; position: absolute; inset: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; font-size: 26px; font-weight: bold; border-radius: inherit; color: var(--accent); }
        .m-info { flex: 1; }
        .m-title { font-size: 17px; font-weight: 700; margin-bottom: 8px; display: flex; justify-content: space-between; }
        .m-medal { font-size: 24px; opacity: 0.2; filter: grayscale(1); transition: all 0.3s; }
        .m-medal.active { opacity: 1; filter: grayscale(0); }
        .m-prog-txt { font-size: 12px; color: var(--text-sub); margin-bottom: 6px; font-weight: 500; }
        .m-prog-bg { width: 100%; height: 4px; background: rgba(255,255,255,0.05); border-radius: 2px; overflow: hidden; }
        .m-prog-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: width 0.3s; }

        /* --- Swipe Play Screen --- */
        #swipe-play { position: absolute; inset: 0; background: var(--bg); z-index: 100; display: none; flex-direction: column; padding: 50px 20px 30px; }
        .sp-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .sp-back { font-size: 16px; font-weight: 600; color: var(--accent); cursor: pointer; padding: 10px 0; }
        .sp-prog-txt { font-size: 11px; color: var(--text-sub); text-align: right; margin-bottom: 6px; font-weight: bold; }
        .sp-img-container { flex: 1; border-radius: var(--radius-l); background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; box-shadow: var(--shadow); margin-bottom: 20px; border: 1px solid var(--border); }
        .sp-img { max-width: 100%; max-height: 100%; object-fit: contain; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease; border-radius: inherit; }
        .swipe-left { transform: translateX(-120%) rotate(-15deg); opacity: 0; }
        .swipe-right { transform: translateX(120%) rotate(15deg); opacity: 0; }
        
        .sp-actions { display: flex; gap: 16px; justify-content: center; }
        .sp-btn { flex: 1; height: 60px; border-radius: var(--radius-m); border: none; font-size: 16px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer; transition: transform 0.1s; }
        .sp-btn:active { transform: scale(0.95); }
        .btn-dislike { background: var(--surface); border: 2px solid var(--danger); color: var(--danger); }
        .btn-like { background: var(--primary); color: #fff; border: 2px solid var(--accent); }

        /* --- Results View --- */
        .res-container { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 20px 0; }
        .res-icon { width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0, 184, 148, 0.3); }
        .res-container h2 { font-size: 24px; margin-bottom: 8px; }
        .res-container p { font-size: 14px; margin-bottom: 30px; }
        .res-stats { width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 35px; }
        .rs-box { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 20px 10px; display: flex; flex-direction: column; align-items: center; }
        .rs-box.danger { border-color: rgba(255, 71, 87, 0.3); background: linear-gradient(to bottom, var(--surface), rgba(255, 71, 87, 0.05)); }
        .rs-box span { font-size: 12px; color: var(--text-sub); margin-bottom: 8px; font-weight: 600; }
        .rs-box strong { font-size: 26px; font-weight: 800; }
        .rs-box.danger strong { color: var(--danger); }

        .btn-primary-act { width: 100%; padding: 16px; border-radius: 12px; border: none; background: var(--danger); color: #fff; font-size: 16px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3); transition: transform 0.2s; }
        .btn-primary-act:active { transform: scale(0.97); }
        .btn-text { width: 100%; padding: 14px; border: none; background: transparent; color: var(--text-sub); font-size: 15px; font-weight: 600; cursor: pointer; margin-top: 10px; }

        /* --- Guide View (ä½¿ã„æ–¹) --- */
        .guide-list { display: flex; flex-direction: column; gap: 16px; margin-top: 10px; }
        .guide-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-m); padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .g-step { font-size: 12px; color: var(--accent); font-weight: 800; letter-spacing: 1px; }
        .g-title { font-size: 18px; font-weight: 700; color: #fff; }
        .g-desc { font-size: 14px; color: var(--text-sub); line-height: 1.6; }
        .g-icon { font-size: 32px; margin-bottom: 4px; }

        /* --- Bottom Navigation --- */
        nav { position: absolute; bottom: 0; left: 0; width: 100%; height: 85px; background: rgba(4, 16, 14, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); display: flex; justify-content: space-around; align-items: center; padding-bottom: 20px; border-top: 1px solid var(--border); z-index: 40; }
        .ni { display: flex; flex-direction: column; align-items: center; color: var(--text-sub); font-size: 10px; font-weight: 600; cursor: pointer; transition: color 0.2s; width: 80px; }
        .ni.on { color: var(--accent); }
        .nic { font-size: 24px; margin-bottom: 4px; }
    </style>
</head>
<body>
<div id="app">
    <header>
        <h1 id="title">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h1>
        <div class="h-actions">
            <button class="btn-icon">âš™</button>
        </div>
    </header>

    <main id="home" class="view active">
        <div class="storage-header">
            <div class="storage-used"><strong id="home-used-sz">45.2 GB</strong> ã‚’ä½¿ç”¨ä¸­ : å…¨ 128 GB</div>
            <div class="storage-pct" id="home-pct-txt">35% ä½¿ç”¨æ¸ˆã¿</div>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="home-prog-bar" style="width: 35%;"></div></div>

        <div class="home-grid">
            <div style="display:flex; flex-direction:column; gap:12px;">
                <div class="card c-sim" onclick="navTo('swipe')">
                    <div class="card-content">
                        <h3>ä¼¼ã¦ã„ã‚‹å†™çœŸ</h3><div class="size" id="card-sz-sim">12.4 GB</div>
                    </div>
                </div>
                <div class="card c-sim-vid" onclick="navTo('swipe')">
                    <div class="card-content">
                        <h3>é¡ä¼¼ã®ãƒ“ãƒ‡ã‚ª</h3><div class="size" id="card-sz-vid">8.1 GB</div>
                    </div>
                </div>
            </div>
            <div style="display:flex; flex-direction:column; gap:12px;">
                <div class="card c-vid" onclick="navTo('swipe')">
                    <div class="card-content">
                        <h3>å‹•ç”»ã‚’æ•´ç†</h3><div class="size" id="card-sz-org">24.5 GB</div>
                    </div>
                </div>
                <div class="card c-ss" onclick="navTo('swipe')">
                    <div class="card-content">
                        <h3>ã‚¹ã‚¯ã‚·ãƒ§</h3><div class="size" id="card-sz-ss">210 MB</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <main id="swipe" class="view">
        <div class="stats-header">
            <div class="stat-box">
                <div class="stat-icon">ğŸ–ï¸</div>
                <div>
                    <div class="stat-label">æ•´ç†ã—ãŸæœˆ:</div>
                    <div class="stat-val" id="reward-cnt">0/15</div>
                </div>
            </div>
            <div class="stat-box">
                <div class="stat-icon">ğŸ§¹</div>
                <div>
                    <div class="stat-label">è§£æ”¾äºˆå®šã®å®¹é‡:</div>
                    <div class="stat-val" id="cleaned-sz">0 MB</div>
                </div>
            </div>
        </div>

        <div class="month-list" id="month-list-container"></div>
    </main>

    <div id="swipe-play">
        <div class="sp-top">
            <div class="sp-back" onclick="closeSwipePlay()">â€¹ æœˆä¸€è¦§ã¸</div>
            <h2 style="font-size:16px; color:#fff;" id="sp-month-title">å¹´æœˆ</h2>
            <div style="width:80px;"></div>
        </div>
        
        <div class="m-prog-bg" style="margin-bottom:8px;"><div class="m-prog-fill" id="sp-prog-bar" style="width: 0%;"></div></div>
        <div class="sp-prog-txt"><span id="sp-txt">0/0</span> ä»¶ã‚’ç¢ºèªæ¸ˆã¿</div>

        <div class="sp-img-container">
            <img id="sp-img" class="sp-img" src="">
        </div>

        <div class="sp-actions">
            <button class="sp-btn btn-dislike" onclick="handleSwipe('del')">ğŸ‘ å‰Šé™¤</button>
            <button class="sp-btn btn-like" onclick="handleSwipe('keep')">ğŸ‘ ä¿æŒ</button>
        </div>
    </div>

    <main id="results" class="view">
        <div class="res-container">
            <div class="res-icon">âœ¨</div>
            <h2>ã‚¹ãƒ¯ã‚¤ãƒ—å®Œäº†ï¼</h2>
            <p id="res-month-title">æ•´ç†ãŒçµ‚ã‚ã‚Šã¾ã—ãŸ</p>
            
            <div class="res-stats">
                <div class="rs-box">
                    <span>æ®‹ã™å†™çœŸ</span>
                    <strong id="res-keep-cnt">0</strong>
                </div>
                <div class="rs-box danger">
                    <span>å‰Šé™¤ã™ã‚‹å†™çœŸ</span>
                    <strong id="res-del-cnt">0</strong>
                    <small id="res-del-sz">0 MB è§£æ”¾</small>
                </div>
            </div>
            
            <button class="btn-primary-act" onclick="executeNativeDeleteMock()">ğŸ—‘ iPhoneã‹ã‚‰å‰Šé™¤ã™ã‚‹</button>
            <button class="btn-text" onclick="closeSwipePlay()">ã‚ã¨ã§å‰Šé™¤ã™ã‚‹</button>
        </div>
    </main>

    <main id="guide" class="view">
        <p style="margin-bottom: 20px;">ã‚¹ãƒãƒ›ã®å†™çœŸã‚’ç¶ºéº—ã«æ•´ç†ã—ã¦ã€ç©ºãå®¹é‡ã‚’å¢—ã‚„ã™ãŸã‚ã®ã‚«ãƒ³ã‚¿ãƒ³ãª3ã¤ã®æ‰‹é †ã§ã™ã€‚</p>
        
        <div class="guide-list">
            <div class="guide-card">
                <div class="g-icon">ğŸ“Š</div>
                <div class="g-step">STEP 1</div>
                <div class="g-title">ãƒ›ãƒ¼ãƒ ã§å®¹é‡ã‚’ç¢ºèªã™ã‚‹</div>
                <div class="g-desc">ã‚¢ãƒ—ãƒªã‚’é–‹ãã¨ã€è‡ªå‹•ã§ã‚¹ãƒãƒ›å†…ã®å†™çœŸã‚’åˆ†æã—ã¾ã™ã€‚ã©ã‚Œãã‚‰ã„ç„¡é§„ãªå†™çœŸã‚„å‹•ç”»ãŒã‚ã‚‹ã‹ã€ã²ã¨ç›®ã§ã‚ã‹ã‚Šã¾ã™ã€‚</div>
            </div>
            
            <div class="guide-card">
                <div class="g-icon">ğŸƒ</div>
                <div class="g-step">STEP 2</div>
                <div class="g-title">ã‚¹ãƒ¯ã‚¤ãƒ—ã§ã‚µã‚¯ã‚µã‚¯ä»•åˆ†ã‘</div>
                <div class="g-desc">ã€Œã‚¹ãƒ¯ã‚¤ãƒ—ã€ã‚¿ãƒ–ã‚’é–‹ãã€æœˆã”ã¨ã«å†™çœŸã‚’ãƒã‚§ãƒƒã‚¯ã€‚ã„ã‚‰ãªã„å†™çœŸã¯å·¦ï¼ˆğŸ‘ï¼‰ã€æ®‹ã™å†™çœŸã¯å³ï¼ˆğŸ‘ï¼‰ã¸ãƒãƒ³ãƒãƒ³ä»•åˆ†ã‘ã¾ã—ã‚‡ã†ã€‚</div>
            </div>

            <div class="guide-card">
                <div class="g-icon">ğŸ—‘ï¸</div>
                <div class="g-step">STEP 3</div>
                <div class="g-title">æœ€å¾Œã«ã¾ã¨ã‚ã¦å‰Šé™¤ï¼</div>
                <div class="g-desc">1ãƒ¶æœˆåˆ†ã®ä»•åˆ†ã‘ãŒçµ‚ã‚ã£ãŸã‚‰ã€ã€ŒiPhoneã‹ã‚‰å‰Šé™¤ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã€‚ã“ã“ã§åˆã‚ã¦å†™çœŸãŒæ¶ˆãˆã€å®¹é‡ãŒã‚°ãƒƒã¨ç©ºãã¾ã™ã€‚</div>
            </div>
        </div>
    </main>

    <nav>
        <div class="ni on" data-t="home" onclick="navTo('home')"><div class="nic">ğŸ </div><span>ãƒ›ãƒ¼ãƒ </span></div>
        <div class="ni" data-t="swipe" onclick="navTo('swipe')"><div class="nic">ğŸƒ</div><span>ã‚¹ãƒ¯ã‚¤ãƒ—</span></div>
        <div class="ni" data-t="guide" onclick="navTo('guide')"><div class="nic">ğŸ“–</div><span>ã‚¬ã‚¤ãƒ‰</span></div>
    </nav>
</div>

<script>
// --- State Management ---
let swipeMonthsData = {}; 
let cleanedTotalMB = 0;
let swipeActiveMonthKey = null;

// ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤ºã•ã›ã‚‹é«˜å“è³ªãªãƒ€ãƒŸãƒ¼ç”»åƒç¾¤
const DEMO_URLS = [
    'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=600&q=80',
    'https://images.unsplash.com/photo-1531306728370-53bfd6202e88?w=600&q=80',
    'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=600&q=80',
    'https://images.unsplash.com/photo-1621360841013-c76831f1a301?w=600&q=80',
    'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=600&q=80',
    'https://images.unsplash.com/photo-1600607688969-a5bfcd64fd28?w=600&q=80',
    'https://images.unsplash.com/photo-1516807869374-4b53db6fcbf4?w=600&q=80'
];

// --- Initialization (15ãƒ¶æœˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ç”Ÿæˆ) ---
document.addEventListener('DOMContentLoaded', () => {
    generate15MonthsData();
    renderSwipeList();
});

function generate15MonthsData() {
    // åŸºæº–æ—¥: 2026å¹´2æœˆ
    let baseDate = new Date(2026, 1, 1); 
    
    for (let i = 0; i < 15; i++) {
        let year = baseDate.getFullYear();
        let month = baseDate.getMonth() + 1;
        let mKey = `${year}-${String(month).padStart(2, '0')}`;
        let title = `${year}å¹´ ${month}æœˆ`;
        
        // æœˆã”ã¨ã®ãƒ©ãƒ³ãƒ€ãƒ ãªå†™çœŸæšæ•° (20ã€œ150æš)
        let count = Math.floor(Math.random() * 130) + 20;
        
        swipeMonthsData[mKey] = {
            id: mKey, title: title, total: count, done: 0, 
            photos: [], kept: 0, deleted: 0, savedMB: 0, isCleaned: false,
            thumb: DEMO_URLS[i % DEMO_URLS.length] // ãƒªã‚¹ãƒˆç”¨ã®ã‚µãƒ ãƒã‚¤ãƒ«
        };

        // å†™çœŸãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
        for(let j = 0; j < count; j++) {
            let sz = Math.round((Math.random() * 4 + 1) * 10) / 10; // 1.0MB ~ 5.0MB
            swipeMonthsData[mKey].photos.push({
                url: DEMO_URLS[(i + j) % DEMO_URLS.length], // ãƒ©ãƒ³ãƒ€ãƒ ç”»åƒ
                szMB: sz
            });
        }
        
        // éå»ã¸1ãƒ¶æœˆæˆ»ã™
        baseDate.setMonth(baseDate.getMonth() - 1);
    }
}

// --- Navigation Logic ---
function navTo(id) {
    document.querySelectorAll('.ni').forEach(x => x.classList.remove('on'));
    const tab = document.querySelector(`.ni[data-t="${id}"]`);
    if(tab) tab.classList.add('on');
    
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    const titles = { home: 'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸', swipe: 'å†™çœŸã‚’ã‚¹ãƒ¯ã‚¤ãƒ—', guide: 'ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰', results: 'æ•´ç†çµæœ' };
    document.getElementById('title').innerText = titles[id] || id;

    if (id === 'swipe') {
        document.getElementById('swipe-list-view').style.display = 'block';
        document.getElementById('swipe-play').style.display = 'none';
    }
}

// --- List Render Logic ---
function renderSwipeList() {
    const cont = document.getElementById('month-list-container');
    const monthsArr = Object.values(swipeMonthsData);
    
    let compCount = 0;
    cont.innerHTML = monthsArr.map(m => {
        const pct = m.total > 0 ? (m.done / m.total) * 100 : 0;
        if(m.isCleaned) compCount++;
        
        return `
            <div class="m-card" onclick="startSwipe('${m.id}')">
                <div class="m-thumb ${m.isCleaned ? 'done' : ''}" style="background-image:url('${m.thumb}')"></div>
                <div class="m-info">
                    <div class="m-title"><span>${m.title}</span><span class="m-medal ${m.isCleaned?'active':''}">ğŸ…</span></div>
                    <div class="m-prog-txt">${m.done}/${m.total} ä»¶ã‚’ç¢ºèªæ¸ˆã¿</div>
                    <div class="m-prog-bg"><div class="m-prog-fill" style="width: ${pct}%"></div></div>
                </div>
            </div>
        `;
    }).join('');
    
    let displayCleaned = cleanedTotalMB < 1000 ? `${cleanedTotalMB.toFixed(1)} MB` : `${(cleanedTotalMB/1000).toFixed(2)} GB`;
    document.getElementById('reward-cnt').innerText = `${compCount}/15`;
    document.getElementById('cleaned-sz').innerText = displayCleaned;
}

// --- Swipe Engine ---
function startSwipe(monthKey) {
    const month = swipeMonthsData[monthKey];
    if (month.isCleaned) { alert("ã“ã®æœˆã¯ã™ã§ã«å‰Šé™¤å®Œäº†ã—ã¦ã„ã¾ã™ã€‚ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼"); return; }
    if (month.done >= month.total) { showResults(monthKey); return; }
    
    swipeActiveMonthKey = monthKey;
    document.getElementById('sp-month-title').innerText = month.title;
    
    document.getElementById('swipe-list-view').style.display = 'none';
    const playView = document.getElementById('swipe-play');
    playView.style.display = 'flex';
    setTimeout(() => { playView.style.opacity = '1'; }, 10);
    
    updateSwipeCard();
}

function updateSwipeCard() {
    const month = swipeMonthsData[swipeActiveMonthKey];
    document.getElementById('sp-txt').innerText = `${month.done}/${month.total}`;
    document.getElementById('sp-prog-bar').style.width = ((month.done / month.total) * 100) + '%';
    
    if (month.done >= month.total) { setTimeout(() => showResults(swipeActiveMonthKey), 400); return; }
    
    const currentImg = month.photos[month.done];
    const imgEl = document.getElementById('sp-img');
    imgEl.className = 'sp-img'; 
    setTimeout(() => { imgEl.src = currentImg.url; }, 50);
}

function handleSwipe(action) {
    const imgEl = document.getElementById('sp-img');
    const month = swipeMonthsData[swipeActiveMonthKey];
    const currentImg = month.photos[month.done];
    
    if (action === 'del') {
        imgEl.classList.add('swipe-left');
        month.deleted++;
        month.savedMB += currentImg.szMB;
    } else {
        imgEl.classList.add('swipe-right');
        month.kept++;
    }
    month.done++;
    setTimeout(() => updateSwipeCard(), 300);
}

function closeSwipePlay() {
    document.getElementById('swipe-play').style.display = 'none';
    navTo('swipe');
    renderSwipeList();
}

// --- Results & Mock Delete ---
function showResults(monthKey) {
    const month = swipeMonthsData[monthKey];
    document.getElementById('res-month-title').innerText = `${month.title} ã®æ•´ç†ãŒçµ‚ã‚ã‚Šã¾ã—ãŸ`;
    document.getElementById('res-keep-cnt').innerText = `${month.kept} æš`;
    document.getElementById('res-del-cnt').innerText = `${month.deleted} æš`;
    document.getElementById('res-del-sz').innerText = `${month.savedMB.toFixed(1)} MB è§£æ”¾å¯èƒ½`;
    
    document.getElementById('swipe-play').style.display = 'none';
    navTo('results');
}

function executeNativeDeleteMock() {
    const month = swipeMonthsData[swipeActiveMonthKey];
    if(month.deleted === 0) {
        alert("å‰Šé™¤ã™ã‚‹å†™çœŸãŒã‚ã‚Šã¾ã›ã‚“ï¼å®Œç’§ãªå†™çœŸãƒ•ã‚©ãƒ«ãƒ€ã§ã™ã€‚");
        month.isCleaned = true; closeSwipePlay(); return;
    }

    // ãƒã‚¤ãƒ†ã‚£ãƒ–é¢¨ã®ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
    if(confirm(`"${month.title}" ã®ä¸è¦ãªå†™çœŸ ${month.deleted}æš ã‚’iPhoneã‹ã‚‰å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n(å‰Šé™¤ã•ã‚ŒãŸå†™çœŸã¯iPhoneã®ã€Œæœ€è¿‘å‰Šé™¤ã—ãŸé …ç›®ã€ã«å…¥ã‚Šã¾ã™)`)) {
        cleanedTotalMB += month.savedMB;
        month.isCleaned = true;
        
        alert(`âœ¨ å‰Šé™¤å®Œäº†ï¼\nå®¹é‡ãŒ ${month.savedMB.toFixed(1)} MB å¢—ãˆã¾ã—ãŸã€‚`);
        closeSwipePlay();
    }
}

// iOSç‰¹æœ‰ã®ãƒã‚¦ãƒ³ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢ï¼ˆã‚¢ãƒ—ãƒªæ„Ÿã‚’å‡ºã™ãŸã‚ï¼‰
document.body.addEventListener('touchmove', function(e) {
    if(!e.target.closest('.view') && !e.target.closest('#swipe-play')) e.preventDefault();
}, { passive: false });

</script>
</body>
</html>
