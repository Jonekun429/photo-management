<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cleaner Pro - Advanced Prototype</title>
    <style>
        :root {
            --bg:#04100e;--card:#0c1f1b;--card2:#153029;--text:#eaf5f2;--sub:#5a7d75;--dim:#3d5c54;
            --pri:#005D4D;--pri2:#00896e;--bright:#00b894;--grad:linear-gradient(135deg,#005D4D,#00896e);
            --glow:rgba(0,93,77,.25);--danger:#ff4757;--dgrad:linear-gradient(135deg,#ff4757,#ff6b7a);
            --amber:#ffb142;--badge:rgba(4,16,14,.82);--bdr:rgba(0,93,77,.12);--bdr2:rgba(0,93,77,.3);
            --sh:0 8px 32px rgba(0,0,0,.4);--rl:20px;--rm:14px;--rs:10px;
        }
        *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
        body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Helvetica Neue",sans-serif;background:#000;display:flex;justify-content:center;touch-action:manipulation;-webkit-font-smoothing:antialiased}
        #app{width:100%;max-width:414px;height:100vh;height:100dvh;background:var(--bg);color:var(--text);position:relative;display:flex;flex-direction:column;overflow:hidden}

        header{padding:52px 20px 10px;display:flex;flex-direction:column;gap:10px;z-index:20;background:var(--bg);flex-shrink:0}
        .h-top{display:flex;justify-content:space-between;align-items:center;height:36px}
        .back{font-size:24px;cursor:pointer;display:none;padding:4px 14px 4px 0;color:var(--bright);transition:opacity .2s;font-weight:300}
        .back:active{opacity:.4}
        .h-act{display:none;gap:8px;align-items:center}
        .h-tr{display:flex;justify-content:space-between;align-items:flex-end}
        h1{font-size:28px;font-weight:700;letter-spacing:-.5px}
        .h-sub{font-size:12.5px;color:var(--sub);margin-top:2px;display:none}
        .gear{background:var(--card);border:1px solid var(--bdr);border-radius:50%;width:38px;height:38px;display:flex;justify-content:center;align-items:center;font-size:17px;cursor:pointer}

        .view{flex:1;overflow-y:auto;padding:0 20px 110px;display:none;-webkit-overflow-scrolling:touch;scrollbar-width:none}
        .view::-webkit-scrollbar{display:none}
        .view.active{display:block;animation:fi .3s ease}
        @keyframes fi{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

        /* ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ãƒãƒ« */
        .access{background:var(--card);border:1px solid var(--bdr2);border-radius:var(--rl);padding:20px;margin-top:15px;overflow:hidden}
        .access-head{text-align:center;margin-bottom:15px}
        .access-head h4{font-size:15px;font-weight:700;margin-bottom:4px}
        .access-head p{font-size:12px;color:var(--sub);line-height:1.5}
        .a-btn{width:100%;padding:14px;border:none;border-radius:12px;font-size:14.5px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s;background:var(--grad);color:#fff;box-shadow:0 4px 16px rgba(0,93,77,.3)}
        .a-btn:active{transform:scale(.97)}
        .a-btn.danger{background:var(--dgrad);box-shadow:0 4px 16px rgba(255,71,87,.3)}
        .a-btn.secondary{background:var(--card2);color:var(--bright);border:1px solid var(--bdr2);box-shadow:none}
        .file-in{display:none}

        /* Home */
        .sto-row{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px}
        .sto-u{font-size:12.5px;color:var(--sub)}.sto-u strong{color:var(--bright);font-weight:600}
        .sto-p{font-size:11px;font-weight:700;color:var(--amber);background:rgba(255,177,66,.1);padding:3px 8px;border-radius:6px}
        .prog{width:100%;height:5px;background:rgba(255,255,255,.04);border-radius:3px;overflow:hidden}
        .pf{width:0;height:100%;background:var(--grad);border-radius:3px;transition:width 1.2s cubic-bezier(.25,.46,.45,.94)}
        
        .gh{display:grid;grid-template-columns:1fr 1fr;gap:13px;margin-top:22px}
        .gc{border-radius:var(--rl);height:130px;position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-end;padding:15px;cursor:pointer;background:var(--card2);background-size:cover;background-position:center;box-shadow:var(--sh)}
        .gc.full{grid-column: 1 / -1; height: 110px;}
        .gc::before{content:'';position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.88) 0%,rgba(0,0,0,.25) 55%,rgba(0,0,0,.08) 100%);z-index:1}
        .gc>div{position:relative;z-index:2}
        .gc.all-photos{background-image:url('https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=600&q=80'); background-position: top;}
        .gc.similar{background-image:url('https://images.unsplash.com/photo-1506157786151-b8491531f063?w=400&q=80');}
        .gc h3{font-size:12.5px;font-weight:500;margin-bottom:2px;opacity:.7}
        .gc p{font-size:21px;font-weight:700;letter-spacing:-.3px}
        .gc.full p{font-size:26px;}

        /* Media Grid (ã™ã¹ã¦) */
        .mg{display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px}
        .mi{aspect-ratio:1/1;position:relative;background:var(--card2);overflow:hidden;cursor:pointer;}
        .mi img{width:100%;height:100%;object-fit:cover;display:block;}

        /* --- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« --- */
        .preview-modal { position:absolute; inset:0; background:rgba(0,0,0,0.95); z-index:999; display:none; flex-direction:column; align-items:center; justify-content:center; opacity:0; transition:opacity 0.3s; }
        .preview-modal.show { display:flex; opacity:1; }
        .preview-img { max-width:100%; max-height:85%; object-fit:contain; border-radius:10px; }
        .preview-close { position:absolute; top:40px; right:20px; width:40px; height:40px; background:rgba(255,255,255,0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#fff; font-size:24px; cursor:pointer; backdrop-filter:blur(5px); }
        .preview-close:active { transform:scale(0.9); }

        /* --- ä¼¼ã¦ã„ã‚‹ç”»åƒ (Similar) UI --- */
        .sim-group { background:var(--card); border:1px solid var(--bdr); border-radius:var(--rl); padding:15px; margin-bottom:20px; }
        .sim-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
        .sim-title { font-size:14px; font-weight:700; }
        .sim-size { font-size:12px; color:var(--bright); background:rgba(0,184,148,0.1); padding:4px 8px; border-radius:6px; font-weight:600; }
        
        .sim-scroll { display:flex; gap:12px; overflow-x:auto; padding-bottom:10px; scrollbar-width:none; }
        .sim-scroll::-webkit-scrollbar { display:none; }
        
        .sim-item { width:120px; flex-shrink:0; border-radius:var(--rm); aspect-ratio:4/5; position:relative; overflow:hidden; border:2.5px solid transparent; transition:all 0.2s; cursor:pointer; }
        .sim-item img { width:100%; height:100%; object-fit:cover; }
        
        /* ãƒ™ã‚¹ãƒˆã‚·ãƒ§ãƒƒãƒˆï¼ˆä¸€ç•ªå·¦ï¼‰ */
        .sim-item.best { border-color:var(--bright); }
        .sim-item.best .badge { position:absolute; top:8px; left:8px; background:var(--bright); color:#000; font-size:10px; font-weight:800; padding:4px 8px; border-radius:6px; z-index:2; }
        
        /* å‰Šé™¤å€™è£œï¼ˆ2æšç›®ä»¥é™ãƒ»é¸æŠçŠ¶æ…‹ï¼‰ */
        .sim-item.ck { border-color:var(--danger); }
        .sim-item.ck img { filter:brightness(0.6); }
        .chk-box { position:absolute; bottom:8px; right:8px; width:24px; height:24px; border:2px solid rgba(255,255,255,0.6); border-radius:50%; display:flex; justify-content:center; align-items:center; color:transparent; font-size:13px; font-weight:bold; z-index:10; background:rgba(0,0,0,0.35); }
        .sim-item.ck .chk-box { background:var(--danger); border-color:var(--danger); color:#fff; }

        /* å‰Šé™¤ãƒãƒ¼ */
        .del-bar{position:absolute;bottom:80px;left:0;width:100%;padding:12px 20px;background:linear-gradient(to top,var(--bg) 70%,transparent);z-index:30;transform:translateY(110%);transition:transform .35s; display:flex;}
        .del-bar.show{transform:translateY(0)}

        .empty { display:none; flex-direction:column; align-items:center; justify-content:center; padding:60px 20px; text-align:center; }
        .e-ic { width:76px; height:76px; background:linear-gradient(135deg,rgba(0,93,77,.18),rgba(0,184,148,.08)); border:1px solid rgba(0,93,77,.18); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:34px; margin-bottom:18px; }
        
        nav{position:absolute;bottom:0;left:0;width:100%;height:78px;background:rgba(4,16,14,.94);backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);display:flex;justify-content:space-around;align-items:center;padding-bottom:18px;border-top:1px solid var(--bdr);z-index:40}
        .ni{display:flex;flex-direction:column;align-items:center;color:var(--dim);font-size:10px;cursor:pointer;transition:color .25s;padding:4px 10px;font-weight:500}
        .ni.on{color:var(--bright)}
        .nic{font-size:22px;margin-bottom:2px}
        .nd{width:4px;height:4px;border-radius:50%;background:var(--bright);margin-top:2px;opacity:0;transition:opacity .25s}
        .ni.on .nd{opacity:1}
    </style>
</head>
<body>
<div id="app">
    <header>
        <div class="h-top">
            <div id="back" class="back" onclick="goBack()">â€¹</div>
            <div id="act" class="h-act"></div>
            <div id="gear" class="gear">âš™</div>
        </div>
        <div class="h-tr">
            <div><h1 id="title">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h1><div id="sub" class="h-sub"></div></div>
        </div>
    </header>

    <main id="home" class="view active">
        <div>
            <div class="sto-row">
                <div class="sto-u"><strong id="sto-txt">0 MB</strong> / èª­è¾¼æ¸ˆ</div>
                <div class="sto-p" id="sto-pct">---</div>
            </div>
            <div class="prog"><div class="pf" id="prog" style="width: 0%;"></div></div>

            <div class="access" id="access-panel">
                <div class="access-head">
                    <h4>ã‚¹ãƒãƒ›ã®å†™çœŸã‚’èª­ã¿è¾¼ã‚€</h4>
                    <p>ç”»åƒã‚’ã‚¿ãƒƒãƒ—ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã€‚<br>ã€Œä¼¼ã¦ã„ã‚‹å†™çœŸã€ã®è‡ªå‹•æ•´ç†ã‚‚ä½“é¨“ã§ãã¾ã™ã€‚</p>
                </div>
                <button class="a-btn" onclick="document.getElementById('fi-files').click()">
                    ğŸ“¸ å†™çœŸã‚’é¸æŠã™ã‚‹
                </button>
                <input type="file" id="fi-files" class="file-in" accept="image/*,video/*" multiple onchange="handleFiles(this.files)">
            </div>

            <div class="gh" id="home-grid">
                <div class="gc full all-photos" onclick="go('all')">
                    <div><h3>ã™ã¹ã¦ã®å†™çœŸ</h3><p id="h-all-sz">0 MB</p></div>
                </div>
                <div class="gc similar full" style="height: 100px;" onclick="go('similar')">
                    <div><h3>ä¼¼ã¦ã„ã‚‹å†™çœŸ</h3><p>è‡ªå‹•æ¤œå‡ºã®ãƒ‡ãƒ¢</p></div>
                </div>
            </div>
        </div>
    </main>

    <main id="all" class="view">
        <div id="all-grid" class="mg"></div>
        <div id="all-empty" class="empty" style="display:flex;"><div class="e-ic">âœ¨</div><h3>å†™çœŸãŒã‚ã‚Šã¾ã›ã‚“</h3></div>
    </main>

    <main id="similar" class="view">
        <p style="font-size:12px; color:var(--sub); margin-bottom:15px;">ä¸€ç•ªå·¦ã®ã€Œãƒ™ã‚¹ãƒˆã‚·ãƒ§ãƒƒãƒˆã€ã‚’æ®‹ã—ã€2æšç›®ä»¥é™ã‚’å‰Šé™¤å€™è£œã¨ã—ã¦è‡ªå‹•é¸æŠã—ã¦ã„ã¾ã™ã€‚</p>
        <div id="similar-container">
            </div>
    </main>

    <div id="del-bar" class="del-bar">
        <button class="a-btn danger" onclick="mockDeleteSimilar()"><span>ğŸ—‘</span> <span id="del-txt">å‰Šé™¤ã™ã‚‹</span></button>
    </div>

    <div id="preview-modal" class="preview-modal" onclick="closePreview()">
        <div class="preview-close">Ã—</div>
        <img id="preview-img" class="preview-img" src="" onclick="event.stopPropagation()">
    </div>

    <nav>
        <div class="ni on" data-t="home"><div class="nic">ğŸ </div><span>ãƒ›ãƒ¼ãƒ </span><div class="nd"></div></div>
        <div class="ni" data-t="all"><div class="nic">ğŸ“</div><span>ã™ã¹ã¦</span><div class="nd"></div></div>
        <div class="ni" data-t="similar"><div class="nic">ğŸ‘¯</div><span>é¡ä¼¼</span><div class="nd"></div></div>
    </nav>
</div>

<script>
let globalFiles = []; 
let currentView = 'home';

// ãƒ‡ãƒ¢ç”¨é¡ä¼¼ç”»åƒãƒ‡ãƒ¼ã‚¿
const SIMILAR_DATA = [
    {
        id: 'g1', count: 3, saved: '5.2 MB',
        photos: [
            { src: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80', isBest: true },
            { src: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80&blur=2', isBest: false },
            { src: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&q=80&sepia=1', isBest: false }
        ]
    },
    {
        id: 'g2', count: 2, saved: '3.8 MB',
        photos: [
            { src: 'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80', isBest: true },
            { src: 'https://images.unsplash.com/photo-1506157786151-b8491531f063?w=300&q=80&blur=3', isBest: false }
        ]
    }
];

function go(id) {
    currentView = id;
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    const titles = { home:'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸', all:'ã™ã¹ã¦ã®å†™çœŸ', similar:'ä¼¼ã¦ã„ã‚‹å†™çœŸ' };
    document.getElementById('title').innerText = titles[id] || id;

    const backBtn = document.getElementById('back');
    const gearBtn = document.getElementById('gear');
    
    if (id === 'home') {
        backBtn.style.display = 'none'; gearBtn.style.display = 'flex';
        document.getElementById('del-bar').classList.remove('show');
    } else {
        backBtn.style.display = 'block'; gearBtn.style.display = 'none';
        if(id === 'similar') updateDelBar();
        else document.getElementById('del-bar').classList.remove('show');
    }
}

function goBack() {
    go('home');
    document.querySelectorAll('.ni').forEach(x => x.classList.remove('on')); 
    document.querySelector('.ni[data-t="home"]').classList.add('on');
}

// ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
function handleFiles(filesList) {
    if(!filesList.length) return;
    globalFiles = [];
    let totalMB = 0;

    for(let f of filesList) {
        if(!f.type.startsWith('image/')) continue;
        let sz = parseFloat((f.size / 1024 / 1024).toFixed(2));
        totalMB += sz;
        
        globalFiles.push({ url: URL.createObjectURL(f), szMB: sz });
    }

    document.getElementById('h-all-sz').innerText = totalMB.toFixed(1) + ' MB';
    document.getElementById('sto-txt').innerText = totalMB.toFixed(1) + ' MB';
    document.getElementById('sto-pct').innerText = 'é€£æºä¸­';
    document.getElementById('prog').style.width = '100%';

    renderAllPhotos();
    go('all');
    document.querySelectorAll('.ni').forEach(x => x.classList.remove('on')); 
    document.querySelector('.ni[data-t="all"]').classList.add('on');
}

// ã™ã¹ã¦ã®å†™çœŸæç”»
function renderAllPhotos() {
    const grid = document.getElementById('all-grid');
    grid.innerHTML = globalFiles.map(p => `
        <div class="mi" onclick="openPreview('${p.url}')">
            <img src="${p.url}" loading="lazy">
        </div>
    `).join('');
    document.getElementById('all-empty').style.display = globalFiles.length ? 'none' : 'flex';
}

// --- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ ---
function openPreview(url) {
    document.getElementById('preview-img').src = url;
    document.getElementById('preview-modal').classList.add('show');
}
function closePreview() {
    document.getElementById('preview-modal').classList.remove('show');
    setTimeout(() => { document.getElementById('preview-img').src = ''; }, 300);
}

// --- ä¼¼ã¦ã„ã‚‹å†™çœŸ UIæç”» ---
function renderSimilar() {
    const cont = document.getElementById('similar-container');
    cont.innerHTML = SIMILAR_DATA.map(g => {
        const items = g.photos.map(p => `
            <div class="sim-item ${p.isBest ? 'best' : 'ck to-del'}" onclick="toggleSimItem(this)">
                ${p.isBest ? '<div class="badge">KEEP</div>' : ''}
                <img src="${p.src}">
                <div class="chk-box">âœ“</div>
            </div>
        `).join('');
        
        return `
            <div class="sim-group" id="${g.id}">
                <div class="sim-header">
                    <span class="sim-title">é¡ä¼¼ã—ãŸå†™çœŸ ${g.count}æš</span>
                    <span class="sim-size">${g.saved} è§£æ”¾å¯èƒ½</span>
                </div>
                <div class="sim-scroll">${items}</div>
            </div>
        `;
    }).join('');
}

// é¡ä¼¼ç”»åƒã®é¸æŠãƒˆã‚°ãƒ«
function toggleSimItem(el) {
    if(el.classList.contains('best')) {
        alert("ã“ã‚Œã¯ãƒ™ã‚¹ãƒˆã‚·ãƒ§ãƒƒãƒˆ(KEEP)ã§ã™ã€‚å¤‰æ›´ã™ã‚‹å ´åˆã¯åˆ¥ã®å†™çœŸã‚’ãƒ™ã‚¹ãƒˆã«æŒ‡å®šã—ã¦ãã ã•ã„ã€‚");
        return;
    }
    el.classList.toggle('ck');
    updateDelBar();
}

// å‰Šé™¤ãƒãƒ¼ã®æ›´æ–°
function updateDelBar() {
    const ckCount = document.querySelectorAll('.sim-item.ck').length;
    const bar = document.getElementById('del-bar');
    if (ckCount > 0) {
        document.getElementById('del-txt').innerText = `${ckCount} æšã‚’iPhoneã‹ã‚‰å‰Šé™¤`;
        bar.classList.add('show');
    } else {
        bar.classList.remove('show');
    }
}

// ç–‘ä¼¼å‰Šé™¤ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (HTMLã§ã®é€£æºãƒ‡ãƒ¢)
function mockDeleteSimilar() {
    const ckItems = document.querySelectorAll('.sim-item.ck');
    if(confirm(`iOSã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç­‰ã¨é€£æºã—ã€${ckItems.length}æšã®å†™çœŸã‚’iPhoneæœ¬ä½“ã‹ã‚‰å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ã€‚\nå®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ`)) {
        // UIä¸Šã‹ã‚‰æ¶ˆã™ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        ckItems.forEach(el => {
            el.style.transform = 'scale(0)';
            el.style.opacity = '0';
            setTimeout(() => el.remove(), 300);
        });
        
        setTimeout(() => {
            alert("å‰Šé™¤ãŒå®Œäº†ã—ã¾ã—ãŸï¼");
            updateDelBar();
        }, 400);
    }
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', () => {
    renderSimilar();
    
    document.querySelectorAll('.ni').forEach(n => {
        n.addEventListener('click', (e) => {
            document.querySelectorAll('.ni').forEach(x => x.classList.remove('on'));
            e.currentTarget.classList.add('on');
            go(e.currentTarget.dataset.t);
        });
    });
});
</script>
</body>
</html>
